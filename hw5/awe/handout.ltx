%% This file is automatically generated. Do not edit!
\documentclass[10pt,usenames]{cwphandout}

\usepackage{graphicx}
\usepackage{color}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{hyperref}
\usepackage{framed}
\usepackage{algorithmic}
\usepackage{algorithm}

\begin{document}
\author{Xinming Wu}
\title{GPGN658: Seismic migration}{AWE}

% ------------------------------------------------------------
In this homework, you will write code for time-domain acoustic
finite-differences modeling. This is one of the most basic programs
employed in seismic imaging. I used in class for this program the name
of ``Hello World!'' of seismic imaging. Everyone involved in seismic
imaging must write this program once in their life. This is what you
will do in this homework.

Your assignment is to modify an acoustic finite-differences modeling
program and compute wavefields and data recorded on the surface. You
will use the constant-density and the variable-density acoustic
wave-equations.

\textbf{This is an individual assignment and absolutely no
  collaboration on code is allowed}.
% ------------------------------------------------------------

% ------------------------------------------------------------
\inputdir{exercise}
% ------------------------------------------------------------
\sideplot{wava}{width=\textwidth}{Source wavelet.}
\sideplot{vp}{width=\textwidth}{Velocity model.}
\sideplot{ro}{width=\textwidth}{Density model.}
\sideplot{wa1}{width=\textwidth}{Wavefield with constant density.}
\sideplot{da1}{width=\textwidth}{Data with constant density.}
\sideplot{wa0}{width=\textwidth}{Wavefield with variable density.}
\sideplot{da0}{width=\textwidth}{Data with variable density.}

% ------------------------------------------------------------
\section{Exercise}

\begin{enumerate}
\item The program \texttt{AFDM.c} implements time-domain
  finite-differences modeling for the constant-density acoustic
  wave-equation. Your task is to add the density term to this
  program. Refer to the course slides for details about what needs to
  be added and where. Add comments in the code to indicate your
  modifications.

\item Run \texttt{scons view} after your code is modified. All figures
  are rebuilt with your new code and displayed on screen.

\item Run \texttt{scons lock} once you are satisfied with your
  results. All figures are copied to the storage directory.

\item Add comments to this document indicating the changes to the
  simulated data and wavefields. Are your results expected? Describe
  the data and wavefield figures indicating what the various events
  represent.\\
  \textcolor{red}{
  For the constant-density acoustic wave-equations, we do not need to make any
  changes to the codes.\\
  For the variable-density acoustic wave equations, please check code changes
  indicated by the gray background in the \texttt{AFDM.c} attached in the end of
  the report.\\
  In Figures 4 and 5 for the constant-density case, the events marked by 1) and 2) 
  in the wave-field figure (Figure 4) are corresponding the events marked 
  by 1) and 2) in the data figure (Figure 5). The event marked by 3) in Figure 4 
  cannot be received and therefore there is no corresponding event in the 
  recorded data shown in Figure 5. Since the density is constant, there is only
  one horizontal interface at $z=$1km (velocity model in Figure 2) that generates 
  reflection events as marked by 2) in Figures 4 and 5.\\
  In Figures 6 and 7 for the variable-density case, the events marked by 1), 2),
  3) and 4) in the wave-field figure (Figure 6) are corresponding the events marked 
  by 1), 2), 3) and 4) in the data figure (Figure 7). The event marked by 5) in Figure 6 
  cannot be received and therefore there is no corresponding event in the 
  recorded data shown in Figure 7. Since the density has a vertical interface at
  $x=$1km, and the velocity has a horizontal interface at $z=$1km. The vertical
  interface generates events marked by 2) in the Figures 6 and 7. The horizontal
  interface generated the events marked by 3) in the Figures 6 and 7. The
  events marked by 4) in Figures 6 and 7 are the scattered waves at the
  intersect point of the vertical and horizontal interface.
  }

\item \texttt{cd awe}, run \texttt{scons handout.read} to build your
  answer. A PDF file is constructed using your newly created figures
  and modifications to the text. The modified code is automatically
  added to the document.

\end{enumerate}

% ------------------------------------------------------------
\section{Wrap-up}

After you are satisfied that your document looks ok, print it from the
PDF viewer and bring it to class.

% ------------------------------------------------------------
\newpage
\section{AFDM.c}
\tiny
\definecolor{keywords}{RGB}{255,0,90}
\definecolor{comments}{RGB}{0,0,113}
\definecolor{red}{RGB}{160,0,0}
\definecolor{green}{RGB}{0,150,0}
\definecolor{gray}{RGB}{168,168,168}
\lstset{numbers=left,language=C, 
        basicstyle=\ttfamily\small, 
        keywordstyle=\color{keywords},
        commentstyle=\color{comments},
        stringstyle=\color{red},
        showstringspaces=false,
        aboveskip=0pt,belowskip=0pt,
        identifierstyle=\color{green}}
%\lstset{numbers=left,xleftmargin=2em,breaklines,language=C, aboveskip=0pt,belowskip=0pt}
\lstinputlisting[firstline=1,lastline=311]{exercise/AFDM.c}
\lstinputlisting[backgroundcolor=\color{gray},firstline=312,lastline=313,
firstnumber=312]{exercise/AFDM.c}
\lstinputlisting[firstline=314,firstnumber=314,lastline=323]{exercise/AFDM.c}
\lstinputlisting[backgroundcolor=\color{gray},firstline=324,lastline=325,
firstnumber=324]{exercise/AFDM.c}
\lstinputlisting[firstline=326,firstnumber=326,lastline=398]{exercise/AFDM.c}
%\lstinputlisting{exercise/AFDM.c}
\normalsize


\end{document}
